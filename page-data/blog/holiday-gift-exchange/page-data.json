{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blog/holiday-gift-exchange/",
    "result": {"data":{"site":{"siteMetadata":{"title":"jordan rhea","siteUrl":"https://jordanrhea.com"}},"markdownRemark":{"id":"a0a4b7c8-a719-5842-9c56-7c725c5738a6","excerpt":"It is the holiday season and I want to share a fun way to engage your students with the spirit of sharing! ​ Many customs and cultures exchange gifts at the…","html":"<p>It is the holiday season and I want to share a fun way to engage your students with the spirit of sharing!</p>\n<p>​<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <iframe src=\"https://www.youtube.com/embed/sShYV2qK6wQ\" frameborder=\"0\" allow=\"autoplay; encrypted-media\" allowfullscreen=\"\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </div></iframe></p>\n<p>Many customs and cultures exchange gifts at the holiday times. This idea was shared with me from my Dutch friends who celebrate Sinterklaas. They exchange gifts and poems.</p>\n<p>That gave me the idea that I could use Google forms to ask students to give their names and a few details about themselves. Then when the teacher decides, end the submissions and pair all of the students secretly!</p>\n<p>It even sends emails to their gmail accounts. Check out the video above for a demonstration on how to setup the project with your class. Below, I am going to talk a little bit about the code</p>\n<p>The <code class=\"language-text\">makeList()</code> function is the main entry point.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">makeList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//1. Close the responses to the form</span>\n  <span class=\"token keyword\">var</span> formUrl <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActiveSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getFormUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  FormApp<span class=\"token punctuation\">.</span><span class=\"token function\">openByUrl</span><span class=\"token punctuation\">(</span>formUrl<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">setAcceptingResponses</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">setCustomClosedFormMessage</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Sorry but the pairs have been made and entry is closed!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//2. Pair the people together</span>\n  <span class=\"token keyword\">var</span> pairs <span class=\"token operator\">=</span> <span class=\"token function\">getPairs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//3. Create an answer sheet</span>\n  <span class=\"token function\">writeSheet</span><span class=\"token punctuation\">(</span>pairs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//4. Send emails to everyone!</span>\n  <span class=\"token function\">sendEmails</span><span class=\"token punctuation\">(</span>pairs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//Done, signal the sheet</span>\n  Browser<span class=\"token punctuation\">.</span><span class=\"token function\">msgBox</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Done creating the pairs and emailing the members'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then, I am using the array method <code class=\"language-text\">.slice()</code> to force a copy of the array of students and an array shuffle function that I found on <a href=\"https://stackoverflow.com\">StackOverflow</a> to shuffle the copy.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">shuffle</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">array</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> currentIndex <span class=\"token operator\">=</span> array<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span>\n    temporaryValue<span class=\"token punctuation\">,</span>\n    randomIndex<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// While there remain elements to shuffle...</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span> <span class=\"token operator\">!==</span> currentIndex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Pick a remaining element...</span>\n    randomIndex <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> currentIndex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    currentIndex <span class=\"token operator\">-=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// And swap it with the current element.</span>\n    temporaryValue <span class=\"token operator\">=</span> array<span class=\"token punctuation\">[</span>currentIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    array<span class=\"token punctuation\">[</span>currentIndex<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> array<span class=\"token punctuation\">[</span>randomIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    array<span class=\"token punctuation\">[</span>randomIndex<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> temporaryValue<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> array<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>I check to make sure that the two arrays are not equal, and if they aren’t, I match up the students. This way, every student has a unique pair.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">isEqual</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">vals<span class=\"token punctuation\">,</span> copy</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> vals<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>vals<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> copy<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Find the complete code and help me to clean up my code a little bit on the <a href=\"https://github.com/rheajt/Holiday-Gift-Exchange\">Github repository</a></h3>","frontmatter":{"title":"Holiday Gift Exchange","date":null,"description":null,"image":{"publicURL":"/static/053829b934c4059483725bb49a775259/maxresdefault.jpg","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#284818","images":{"fallback":{"src":"/static/053829b934c4059483725bb49a775259/4a49b/maxresdefault.jpg","srcSet":"/static/053829b934c4059483725bb49a775259/b4dad/maxresdefault.jpg 320w,\n/static/053829b934c4059483725bb49a775259/3440d/maxresdefault.jpg 640w,\n/static/053829b934c4059483725bb49a775259/4a49b/maxresdefault.jpg 1280w","sizes":"(min-width: 1280px) 1280px, 100vw"},"sources":[{"srcSet":"/static/053829b934c4059483725bb49a775259/c0bcc/maxresdefault.webp 320w,\n/static/053829b934c4059483725bb49a775259/17574/maxresdefault.webp 640w,\n/static/053829b934c4059483725bb49a775259/71d4d/maxresdefault.webp 1280w","type":"image/webp","sizes":"(min-width: 1280px) 1280px, 100vw"}]},"width":1280,"height":720}}}},"fields":{"date":"Tue Nov 28 2017 08:00:00 GMT+0800 (China Standard Time)","thumbnail":"sShYV2qK6wQ","slug":"holiday-gift-exchange/"}},"previous":{"fields":{"slug":"the-properties-service/"},"frontmatter":{"title":"The Properties Service"}},"next":{"fields":{"slug":"adding-rows-to-a-sheet-from-a-webapp/"},"frontmatter":{"title":"Adding Rows to a Sheet from a WebApp"}}},"pageContext":{"id":"a0a4b7c8-a719-5842-9c56-7c725c5738a6","previousPostId":"75441768-ccd1-54d6-b23a-31c4fa5b2193","nextPostId":"cb7e12e2-ffe4-52fd-89e8-c477750f1094"}},
    "staticQueryHashes": ["1324386404","4144781314"]}