{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blog/build-a-zillow-pricing-custom-function/",
    "result": {"data":{"site":{"siteMetadata":{"title":"jordan rhea"}},"markdownRemark":{"id":"d10913df-438b-569b-90ad-12c9419218b1","excerpt":"There are tons of ways to incorporate data from external services into your spreadsheets.  is a good example. Good news! It is easy to roll your own version of…","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/78f52e30d755ebae0bd10407450c3509/cdef6/zillow-spreadsheet.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.53164556962025%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACH0lEQVQoz2WTW27TQBSGsxd4bdXNwANQ9sITy2BFUNrQKnZsx57x3Unj8S12fPmqmQYkYKSRJev4m/n+c7zKspyi2LPb+QghkDJGBt8IxReS8hfRMSKtJIkKiSuBLD3SOkRWHlHh8yxi6jiijUPasmRlWTZRFDOOI/M8kWVHsug9wn1Dnt8ho5y2q8mKjGkZ8YXPcB6oGoUXhARRQ9sOtE3PqT+zur9/IAgEyzKjV5oeSOQn3M0NaXKH50WcTh1JkrDMC67rcT6PqLJkY+3YioaqGVDNQHu6AH0/YJ41cCFJ9iTyA551TRx9x3EkXdcQhiHLsmDbW/p+QKmS9aPLk1dfLrOY50oXxHFsgPpFUSiK5BbpXZPn9wiR0bYNWZaZGm0zDGfqSmFtBW7YMk4T02WvrI1FFEUmPw3M85I8viVwrwwwDHNOp5aiKEyNlJLzWQMrHE/iyIZxnMxhBvi/8sEo7+xr4viHyVDrSRmajLdbxyhXSrGxdzy6lQEuBjizenhY/wVMkwNp+BHPuroAQ47HZ3zfN0DXcRmGAVUeWT+5rJ1/gFt7a8bmj3J2pEg+E/k3RlmGOU1Tv3Z5Wcys9n1PU9fYjmAXd0ZVf2+UXdflcHg2c6iBSp045nps3pKlP01T+r67ZDibH0Ar13XFxg4QSXfJ75KhVlFKMU2vg61X33wl8N5RFBuETBmGnv3+YLReuzzQ/AamnbmIhur9AgrzMGs5T00bAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Zillow Spreadsheet\"\n        title=\"Zillow Spreadsheet\"\n        src=\"/static/78f52e30d755ebae0bd10407450c3509/f058b/zillow-spreadsheet.png\"\n        srcset=\"/static/78f52e30d755ebae0bd10407450c3509/c26ae/zillow-spreadsheet.png 158w,\n/static/78f52e30d755ebae0bd10407450c3509/6bdcf/zillow-spreadsheet.png 315w,\n/static/78f52e30d755ebae0bd10407450c3509/f058b/zillow-spreadsheet.png 630w,\n/static/78f52e30d755ebae0bd10407450c3509/40601/zillow-spreadsheet.png 945w,\n/static/78f52e30d755ebae0bd10407450c3509/cdef6/zillow-spreadsheet.png 1163w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>There are tons of ways to incorporate data from external services into your spreadsheets. <code class=\"language-text\">=GOOGLEFINANCE('GOOG', 'price')</code> is a good example.</p>\n<p>Good news! It is easy to roll your own version of this for outside services too!</p>\n<p>But how do we go about doing that? First you need to open your script editor. Any functions you build in here can be accessed by the bound document.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token constant\">GETZESTIMATE</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">address<span class=\"token punctuation\">,</span> citystatezip</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// your code will go here</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>When I am writing custom functions I stick to the standard format of all capital letters. We can use this function with <code class=\"language-text\">=GETZESTIMATE(...)</code> from the spreadsheet just like all of the built in functions.</p>\n<p>But what does the code itself look like? Well, that is the tricky part. For this example, here you go. Comments in the function try to explain what I am doing</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> <span class=\"token constant\">ZWSID</span> <span class=\"token operator\">=</span> PropertiesService<span class=\"token punctuation\">.</span><span class=\"token function\">getUserProperties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ZWSID'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//check that you have defined an API key in the User Properties</span>\n<span class=\"token comment\">//to get an API key check: https://www.zillow.com/howto/api/APIOverview.htm</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token constant\">ZWSID</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'Need to set an API key'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> url <span class=\"token operator\">=</span> <span class=\"token string\">'http://www.zillow.com/webservice/GetSearchResults.htm?'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//the first parameter is the address to get an estimate for</span>\n<span class=\"token comment\">//if you pass a single cell no problem</span>\n<span class=\"token comment\">//if you pass a range of cells it reduces the into a string</span>\n<span class=\"token keyword\">var</span> addressParam <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> address <span class=\"token operator\">===</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token operator\">?</span> address\n  <span class=\"token operator\">:</span> address<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> cur</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">return</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>acc <span class=\"token operator\">+</span> <span class=\"token string\">' '</span> <span class=\"token operator\">+</span> cur<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//similar situation for city/state/zip code</span>\n<span class=\"token keyword\">var</span> citystatezipParam <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> citystatezip <span class=\"token operator\">===</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token operator\">?</span> citystatezip\n  <span class=\"token operator\">:</span> citystatezip<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> cur</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">return</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>acc <span class=\"token operator\">+</span> <span class=\"token string\">' '</span> <span class=\"token operator\">+</span> cur<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//create an object for the request objects</span>\n<span class=\"token keyword\">var</span> queryParams <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token string\">'zws-id='</span> <span class=\"token operator\">+</span> <span class=\"token constant\">ZWSID</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'address='</span> <span class=\"token operator\">+</span> addressParam<span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'citystatezip='</span> <span class=\"token operator\">+</span> citystatezipParam\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&amp;'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//fetch the Zestimate from the API and parse it into an XML object</span>\n<span class=\"token keyword\">var</span> xml <span class=\"token operator\">=</span> UrlFetchApp<span class=\"token punctuation\">.</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>url <span class=\"token operator\">+</span> queryParams<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getContentText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> document <span class=\"token operator\">=</span> XmlService<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>xml<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//return the Zestimate to the spreadsheet! This is what appears on your spreadsheet</span>\n<span class=\"token keyword\">return</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getRootElement</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">'response'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">'results'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">getChildren</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">'zestimate'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">getChild</span><span class=\"token punctuation\">(</span><span class=\"token string\">'amount'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Pretty cool right? Well let’s go one step further and actually provide some help to ourselves when we use this in the spreadsheet. It is always nice to see those popups so we can be reminded what the parameters of our function actually do.</p>\n<p>Just add this directly above the function!</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * get the ZPID for a location from the zillow api\n *@param {\"1600 Pennsylvania Ave\"} address The street address to search. (optional) You can use a range of values if you store the address in multiple cells\n *@param {\"Washington DC\"} citystatezip The city, state, and zip code to search. (optional) You can use a range of values if you store the address in multiple cells\n *@return {number} The Zestimate of the property found\n *@customfunction\n */</span></code></pre></div>\n<p>This is a pretty useful tool if you work in real estate or if you are just interested in buying a house. There are tons of other services that can easily be integrated. Happy coding!</p>","frontmatter":{"title":"Build a Zillow Pricing Custom Function","date":null,"description":null},"fields":{"date":"Thu Feb 07 2019 08:00:00 GMT+0800 (China Standard Time)"}},"previous":{"fields":{"slug":"New-Innovator-Dashboard/"},"frontmatter":{"title":"New Innovator Dashboard"}},"next":{"fields":{"slug":"comment-harvester-at-long-last/"},"frontmatter":{"title":"Comment Harvester ... At Long Last!"}}},"pageContext":{"id":"d10913df-438b-569b-90ad-12c9419218b1","previousPostId":"b3e82c54-6f15-5973-b304-b81f0cb72ced","nextPostId":"4c51f623-4bdd-5239-ac27-1f52acde99e8"}},
    "staticQueryHashes": ["2841359383","4144781314"]}