{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blog/covid-19-query-time/",
    "result": {"data":{"site":{"siteMetadata":{"title":"jordan rhea"}},"markdownRemark":{"id":"8e1cc2f3-0540-5cdc-9f28-aa5e6b7d8c69","excerpt":"More problems have arisen! They changed the format of the CSV files in the Github Repository. Gee whiz! Well that is something that we can fix, and at the same…","html":"<div class=\"gatsby-resp-iframe-wrapper\" style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem\" > <iframe src=\"https://www.youtube.com/embed/_We0zGK3aWY\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\" style=\" position: absolute; top: 0; left: 0; width: 100%; height: 100%; \"></iframe> </div>\n<h2>More problems have arisen! They changed the format of the CSV files in the Github Repository.</h2>\n<p>Gee whiz! Well that is something that we can fix, and at the same time make our code a little more robust.</p>\n<p>Before we do that though, let’s look at the data we already do have. To do that, we need to write a few QUERY statements to shine a little clarity on our situation. This won’t be an exhaustive tutorial on the QUERY function, however, it will give you just enough information to get you into trouble.</p>\n<p>First we can bring in our data with a little bit of a filter. Specifically a filter by date.</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\"><span class=\"token operator\">=</span><span class=\"token function-name keyword\">QUERY</span><span class=\"token punctuation\">(</span><span class=\"token reference string\"><span class=\"token punctuation\">'</span><span class=\"token sheet function\">COVID-19 Daily Reports</span><span class=\"token punctuation\">'</span><span class=\"token operator\">!</span></span><span class=\"token range property\"><span class=\"token column\">A</span><span class=\"token operator\">:</span><span class=\"token column\">I</span></span><span class=\"token operator\">,</span> <span class=\"token string\">\"select B, C, E, F, G WHERE A = date '\"</span><span class=\"token operator\">&amp;</span> <span class=\"token function-name keyword\">TEXT</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">H1</span><span class=\"token operator\">,</span> <span class=\"token string\">\"yyyy-mm-dd\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token string\">\"'\"</span><span class=\"token operator\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Then we can add in a Country filter, and a little extra data for fun.</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\"><span class=\"token operator\">=</span><span class=\"token function-name keyword\">TRANSPOSE</span><span class=\"token punctuation\">(</span><span class=\"token function-name keyword\">QUERY</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A2</span>:E<span class=\"token operator\">,</span> <span class=\"token string\">\"select sum(C), sum(D), sum(E) WHERE B = '\"</span><span class=\"token operator\">&amp;</span><span class=\"token cell property\">H2</span><span class=\"token operator\">&amp;</span><span class=\"token string\">\"' LABEL sum(C) 'Confirmed', sum(D) 'Death', sum(E) 'Recovered'\"</span><span class=\"token operator\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Lets add a sheet that</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\"><span class=\"token operator\">=</span><span class=\"token function-name keyword\">QUERY</span><span class=\"token punctuation\">(</span><span class=\"token reference string\"><span class=\"token punctuation\">'</span><span class=\"token sheet function\">COVID-19 Daily Reports</span><span class=\"token punctuation\">'</span><span class=\"token operator\">!</span></span><span class=\"token range property\"><span class=\"token column\">A</span><span class=\"token operator\">:</span><span class=\"token column\">I</span></span><span class=\"token operator\">,</span> <span class=\"token string\">\"select A, count(B), sum(E), sum(F), sum(G) WHERE A is not null GROUP BY A LABEL count(B) 'Countries'\"</span><span class=\"token operator\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Comment below if you have comments or suggestions. For a more exhaustive look at the <code class=\"language-text\">QUERY</code> function, <a href=\"https://www.benlcollins.com/spreadsheets/google-sheets-query-sql/\">check out this post from Ben Collins</a>!</p>","frontmatter":{"title":"Covid-19 Query Time","date":null,"description":null},"fields":{"date":"Wed Mar 25 2020 08:00:00 GMT+0800 (China Standard Time)"}},"previous":{"fields":{"slug":"update-sheet-from-remote-csv-files/"},"frontmatter":{"title":"Update Sheet from Remote CSV Files"}},"next":{"fields":{"slug":"fun-with-cloud-functions/"},"frontmatter":{"title":"Fun with Cloud Functions"}}},"pageContext":{"id":"8e1cc2f3-0540-5cdc-9f28-aa5e6b7d8c69","previousPostId":"1dde8022-8f88-53f1-9454-df818d93ffdb","nextPostId":"ba471bf7-652a-5e23-ab22-525b5b333b42"}},
    "staticQueryHashes": ["2841359383","4144781314"]}