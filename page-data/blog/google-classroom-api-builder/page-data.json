{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blog/google-classroom-api-builder/",
    "result": {"data":{"site":{"siteMetadata":{"title":"jordan rhea"}},"markdownRemark":{"id":"7a11947e-ccee-5c46-ae80-2075425788cb","excerpt":"","html":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 1. get the courses from the spreadsheet</span>\n  <span class=\"token keyword\">const</span> courses <span class=\"token operator\">=</span> <span class=\"token function\">getCoursesFromSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 2. create the courses on the classroom</span>\n\n  <span class=\"token keyword\">const</span> responses <span class=\"token operator\">=</span> courses<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">course<span class=\"token punctuation\">,</span> ind</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> resource <span class=\"token operator\">=</span> <span class=\"token function\">createCourseResource</span><span class=\"token punctuation\">(</span>course<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> Classroom<span class=\"token punctuation\">.</span>Courses<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>resource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    course<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>alternateLink<span class=\"token punctuation\">;</span>\n    course<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>enrollmentCode<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> course<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 3. write the course url and share code the spreadsheet</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">writeCoursesToSpreadsheet</span><span class=\"token punctuation\">(</span>responses<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">writeCoursesToSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">courses</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> ss <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> sheet <span class=\"token operator\">=</span> ss<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'CourseSingleSheet'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> range <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>\n    <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getLastRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getLastColumn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//set new values</span>\n  range<span class=\"token punctuation\">.</span><span class=\"token function\">setValues</span><span class=\"token punctuation\">(</span>courses<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getCoursesFromSpreadsheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> ss <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">getActive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> sheet <span class=\"token operator\">=</span> ss<span class=\"token punctuation\">.</span><span class=\"token function\">getSheetByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">'CourseSingleSheet'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getDataRange</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  data<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">row</span> <span class=\"token operator\">=></span> row <span class=\"token operator\">!==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">createCourseResource</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">course</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>courseName<span class=\"token punctuation\">,</span> instructorName<span class=\"token punctuation\">,</span> instructorEmail<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> course<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> resource <span class=\"token operator\">=</span> Classroom<span class=\"token punctuation\">.</span><span class=\"token function\">newCourse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  resource<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> courseName<span class=\"token punctuation\">;</span>\n  resource<span class=\"token punctuation\">.</span>ownerId <span class=\"token operator\">=</span> <span class=\"token string\">'me'</span><span class=\"token punctuation\">;</span>\n  resource<span class=\"token punctuation\">.</span>description <span class=\"token operator\">=</span> instructorName<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> resource<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"Google Classroom API Builder","date":null,"description":null},"fields":{"date":"Fri Mar 20 2020 08:00:00 GMT+0800 (China Standard Time)"}},"previous":{"fields":{"slug":"covid-19-query-time/"},"frontmatter":{"title":"Covid-19 Query Time"}},"next":{"fields":{"slug":"fun-with-cloud-functions/"},"frontmatter":{"title":"Fun with Cloud Functions"}}},"pageContext":{"id":"7a11947e-ccee-5c46-ae80-2075425788cb","previousPostId":"19d7e169-43db-5fa9-a16b-2a3214435347","nextPostId":"c79c59e0-9ed8-5fdf-8fc2-710bd067fd59"}},
    "staticQueryHashes": ["2841359383","4144781314"]}