{"componentChunkName":"component---src-templates-post-js","path":"/covid-19-query-time/","result":{"data":{"markdownRemark":{"html":"<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/_We0zGK3aWY\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n<h2>More problems have arisen! They changed the format of the CSV files in the Github Repository.</h2>\n<p>Gee whiz! Well that is something that we can fix, and at the same time make our code a little more robust.</p>\n<p>Before we do that though, let’s look at the data we already do have. To do that, we need to write a few QUERY statements to shine a little clarity on our situation. This won’t be an exhaustive tutorial on the QUERY function, however, it will give you just enough information to get you into trouble.</p>\n<p>First we can bring in our data with a little bit of a filter. Specifically a filter by date.</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\"><span class=\"token operator\">=</span><span class=\"token function-name keyword\">QUERY</span><span class=\"token punctuation\">(</span><span class=\"token reference string\"><span class=\"token punctuation\">'</span><span class=\"token sheet function\">COVID-19 Daily Reports</span><span class=\"token punctuation\">'</span><span class=\"token operator\">!</span></span><span class=\"token range property\"><span class=\"token column\">A</span><span class=\"token operator\">:</span><span class=\"token column\">I</span></span><span class=\"token operator\">,</span> <span class=\"token string\">\"select B, C, E, F, G WHERE A = date '\"</span><span class=\"token operator\">&amp;</span> <span class=\"token function-name keyword\">TEXT</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">H1</span><span class=\"token operator\">,</span> <span class=\"token string\">\"yyyy-mm-dd\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token string\">\"'\"</span><span class=\"token operator\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Then we can add in a Country filter, and a little extra data for fun.</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\"><span class=\"token operator\">=</span><span class=\"token function-name keyword\">TRANSPOSE</span><span class=\"token punctuation\">(</span><span class=\"token function-name keyword\">QUERY</span><span class=\"token punctuation\">(</span><span class=\"token cell property\">A2</span>:E<span class=\"token operator\">,</span> <span class=\"token string\">\"select sum(C), sum(D), sum(E) WHERE B = '\"</span><span class=\"token operator\">&amp;</span><span class=\"token cell property\">H2</span><span class=\"token operator\">&amp;</span><span class=\"token string\">\"' LABEL sum(C) 'Confirmed', sum(D) 'Death', sum(E) 'Recovered'\"</span><span class=\"token operator\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Lets add a sheet that</p>\n<div class=\"gatsby-highlight\" data-language=\"xlsx\"><pre class=\"language-xlsx\"><code class=\"language-xlsx\"><span class=\"token operator\">=</span><span class=\"token function-name keyword\">QUERY</span><span class=\"token punctuation\">(</span><span class=\"token reference string\"><span class=\"token punctuation\">'</span><span class=\"token sheet function\">COVID-19 Daily Reports</span><span class=\"token punctuation\">'</span><span class=\"token operator\">!</span></span><span class=\"token range property\"><span class=\"token column\">A</span><span class=\"token operator\">:</span><span class=\"token column\">I</span></span><span class=\"token operator\">,</span> <span class=\"token string\">\"select A, count(B), sum(E), sum(F), sum(G) WHERE A is not null GROUP BY A LABEL count(B) 'Countries'\"</span><span class=\"token operator\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Comment below if you have comments or suggestions. For a more exhaustive look at the <code class=\"language-text\">QUERY</code> function, <a href=\"https://www.benlcollins.com/spreadsheets/google-sheets-query-sql/\">check out this post from Ben Collins</a>!</p>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"iframe","properties":{"width":560,"height":315,"src":"https://www.youtube.com/embed/_We0zGK3aWY","frameBorder":"0","allow":"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture","allowFullScreen":true},"children":[]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"More problems have arisen! They changed the format of the CSV files in the Github Repository."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Gee whiz! Well that is something that we can fix, and at the same time make our code a little more robust."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Before we do that though, let’s look at the data we already do have. To do that, we need to write a few QUERY statements to shine a little clarity on our situation. This won’t be an exhaustive tutorial on the QUERY function, however, it will give you just enough information to get you into trouble."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"First we can bring in our data with a little bit of a filter. Specifically a filter by date."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"xlsx"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-xlsx"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-xlsx"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["token","function-name","keyword"]},"children":[{"type":"text","value":"QUERY"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","reference","string"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["token","sheet","function"]},"children":[{"type":"text","value":"COVID-19 Daily Reports"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"!"}]}]},{"type":"element","tagName":"span","properties":{"className":["token","range","property"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","column"]},"children":[{"type":"text","value":"A"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["token","column"]},"children":[{"type":"text","value":"I"}]}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"select B, C, E, F, G WHERE A = date '\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"&"}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","function-name","keyword"]},"children":[{"type":"text","value":"TEXT"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","cell","property"]},"children":[{"type":"text","value":"H1"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"yyyy-mm-dd\""}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"&"}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"'\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Then we can add in a Country filter, and a little extra data for fun."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"xlsx"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-xlsx"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-xlsx"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["token","function-name","keyword"]},"children":[{"type":"text","value":"TRANSPOSE"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","function-name","keyword"]},"children":[{"type":"text","value":"QUERY"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","cell","property"]},"children":[{"type":"text","value":"A2"}]},{"type":"text","value":":E"},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"select sum(C), sum(D), sum(E) WHERE B = '\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"&"}]},{"type":"element","tagName":"span","properties":{"className":["token","cell","property"]},"children":[{"type":"text","value":"H2"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"&"}]},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"' LABEL sum(C) 'Confirmed', sum(D) 'Death', sum(E) 'Recovered'\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Lets add a sheet that"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"xlsx"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-xlsx"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-xlsx"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["token","function-name","keyword"]},"children":[{"type":"text","value":"QUERY"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["token","reference","string"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["token","sheet","function"]},"children":[{"type":"text","value":"COVID-19 Daily Reports"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":"!"}]}]},{"type":"element","tagName":"span","properties":{"className":["token","range","property"]},"children":[{"type":"element","tagName":"span","properties":{"className":["token","column"]},"children":[{"type":"text","value":"A"}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["token","column"]},"children":[{"type":"text","value":"I"}]}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","string"]},"children":[{"type":"text","value":"\"select A, count(B), sum(E), sum(F), sum(G) WHERE A is not null GROUP BY A LABEL count(B) 'Countries'\""}]},{"type":"element","tagName":"span","properties":{"className":["token","operator"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tagName":"span","properties":{"className":["token","number"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Comment below if you have comments or suggestions. For a more exhaustive look at the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"QUERY"}]},{"type":"text","value":" function, "},{"type":"element","tagName":"a","properties":{"href":"https://www.benlcollins.com/spreadsheets/google-sheets-query-sql/"},"children":[{"type":"text","value":"check out this post from Ben Collins"}]},{"type":"text","value":"!"}]}],"data":{"quirksMode":false}},"excerpt":"More problems have arisen! They changed the format of the CSV files in the Github Repository. Gee whiz! Well that is something that we can…","timeToRead":1,"fields":{"date":"24 March 2020","slug":"covid-19-query-time/"},"frontmatter":{"title":"Covid-19 Query Time","tags":["Projects","google apps script","javascript","solutions"],"image":null}},"site":{"siteMetadata":{"siteUrl":"https://jordanrhea.com"}}},"pageContext":{"slug":"covid-19-query-time/","prev":{"excerpt":"We already pulled some data from a CSV file stored on Github. Now we need a way to update this. Here is a down and dirty implementation of…","timeToRead":1,"frontmatter":{"title":"Update Sheet from Remote CSV Files","tags":["projects","google apps script","javascript","solutions","csv","google sheets","github"],"image":{"childImageSharp":{"fluid":{"aspectRatio":1.7782026768642447,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEDAv/EABYBAQEBAAAAAAAAAAAAAAAAAAMAAv/aAAwDAQACEAMQAAABlqSEQRm//8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAEAIhIv/aAAgBAQABBQLFTmnoFV//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAgEBPwGH/8QAGhAAAgIDAAAAAAAAAAAAAAAAARAAQREhcf/aAAgBAQAGPwLYHZSxT//EABwQAAICAgMAAAAAAAAAAAAAAAERACFBcRAxYf/aAAgBAQABPyElwMnLig2jCWaC8jdmkITHH//aAAwDAQACAAMAAAAQ2N//xAAWEQEBAQAAAAAAAAAAAAAAAAARARD/2gAIAQMBAT8QaZ//xAAWEQEBAQAAAAAAAAAAAAAAAAABERD/2gAIAQIBAT8QYCZ//8QAGxABAQACAwEAAAAAAAAAAAAAAREAMRAhQaH/2gAIAQEAAT8QZJjYFe9dZWDwKe/3CVEvjRgbKpr4uUTGS8f/2Q==","sizes":"(max-width: 1280px) 100vw, 1280px","src":"/static/c55e4c349e349ceda4c85f8e9cf87de8/ec6c5/thumbnail.jpg","srcSet":"/static/c55e4c349e349ceda4c85f8e9cf87de8/2f037/thumbnail.jpg 930w,\n/static/c55e4c349e349ceda4c85f8e9cf87de8/ec6c5/thumbnail.jpg 1280w"}}}},"fields":{"layout":"","slug":"update-sheet-from-remote-csv-files/","date":"2020-03-23T16:00:00.000Z"}},"next":{"excerpt":"Cloud functions! Easy way to process HTTP requests without setting up an entire server. Plus they are cheap! Plus you can use any language…","timeToRead":1,"frontmatter":{"title":"Fun with Cloud Functions","tags":["Projects","google apps script","javascript","solutions"],"image":{"childImageSharp":{"fluid":{"aspectRatio":1.7782026768642447,"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIEAf/EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAFtmS8qgGf/xAAaEAACAwEBAAAAAAAAAAAAAAABAgADMhIT/9oACAEBAAEFAvJCXqrMVeQ+omf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAwEBPwGn/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAS/9oACAECAQE/AZK//8QAGRAAAwEBAQAAAAAAAAAAAAAAAQIRACAi/9oACAEBAAY/Aqz7yQulB4//xAAcEAEAAgEFAAAAAAAAAAAAAAABABEQITFBUXH/2gAIAQEAAT8hEd9wMYKLu5Q+oQFsDRP/2gAMAwEAAgADAAAAED/f/8QAFhEBAQEAAAAAAAAAAAAAAAAAAREA/9oACAEDAQE/EASTO//EABYRAQEBAAAAAAAAAAAAAAAAABEBAP/aAAgBAgEBPxBqulN//8QAGxABAAMBAAMAAAAAAAAAAAAAAQARITFBUXH/2gAIAQEAAT8QCWYag8gIYOlb9JVhdbc7LDXmALuwCg9z/9k=","sizes":"(max-width: 1280px) 100vw, 1280px","src":"/static/a7e803e865b2dd4072ff2942c25865aa/ec6c5/cloud-functions.jpg","srcSet":"/static/a7e803e865b2dd4072ff2942c25865aa/2f037/cloud-functions.jpg 930w,\n/static/a7e803e865b2dd4072ff2942c25865aa/ec6c5/cloud-functions.jpg 1280w"}}}},"fields":{"layout":"","slug":"fun-with-cloud-functions/","date":"2020-03-27T16:00:00.000Z"}},"primaryTag":"Projects"}},"staticQueryHashes":["1210899092"]}